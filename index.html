<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°è‚¡ K ç·šå‹æ…‹å¿«ç¯©</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f8f9fa; padding-top: 20px; }
        .card { margin-bottom: 15px; border: none; shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .pattern-tag { background-color: #e3f2fd; color: #0d6efd; padding: 2px 8px; border-radius: 4px; font-size: 0.9em; margin-right: 5px; }
        .price-up { color: #dc3545; font-weight: bold; }
        .price-down { color: #198754; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <h3 class="text-center mb-4">ğŸ“ˆ å°è‚¡æŠ€è¡“å‹æ…‹æŸ¥è©¢</h3>
    
    <div class="input-group mb-4">
        <input type="text" id="searchInput" class="form-control" placeholder="è¼¸å…¥è‚¡ç¥¨ä»£è™Ÿ (ä¾‹å¦‚: 2330)">
        <button class="btn btn-primary" type="button" onclick="searchStock()">æŸ¥è©¢</button>
    </div>

    <div id="resultArea">
        <div class="alert alert-info">è«‹è¼¸å…¥ä»£è™ŸæŸ¥è©¢ï¼Œè³‡æ–™æ›´æ–°æ—¥æœŸï¼š<span id="dataDate">è®€å–ä¸­...</span></div>
    </div>
</div>

<script>
    let stockData = {};

    // 1. ç¶²é è¼‰å…¥æ™‚ï¼Œè®€å– JSON è³‡æ–™
    fetch('stock_data.json')
        .then(response => response.json())
        .then(data => {
            stockData = data;
            // éš¨ä¾¿æŠ“ä¸€ç­†è³‡æ–™çš„æ—¥æœŸä¾†é¡¯ç¤ºæ›´æ–°æ™‚é–“
            const firstKey = Object.keys(data)[0];
            if(firstKey) {
                document.getElementById('dataDate').innerText = data[firstKey].date;
            }
        })
        .catch(error => console.error('Error loading data:', error));

    // 2. æœå°‹åŠŸèƒ½
    function searchStock() {
        const input = document.getElementById('searchInput').value.trim();
        const resultArea = document.getElementById('resultArea');
        
        if (!input) return;

        if (stockData[input]) {
            const data = stockData[input];
            const patternHtml = data.patterns.map(p => `<span class="pattern-tag">${p}</span>`).join('');
            
            resultArea.innerHTML = `
                <div class="card">
                    <div class="card-body">
                        <h4 class="card-title">${input}</h4>
                        <p class="card-text">æ”¶ç›¤åƒ¹: <span class="price-up">${data.price}</span></p>
                        <hr>
                        <h6>ç›®å‰æŠ€è¡“å‹æ…‹ï¼š</h6>
                        <div class="mb-2">${patternHtml}</div>
                        <div class="mt-3">
                            <small class="text-muted">æ›´å¤šè©³æƒ…åƒè€ƒï¼š</small><br>
                            <a href="https://histock.tw/stock/${input}" target="_blank">HiStock</a> | 
                            <a href="https://goodinfo.tw/tw/StockDetail.asp?STOCK_ID=${input}" target="_blank">Goodinfo</a>
                        </div>
                    </div>
                </div>
            `;
        } else {
            resultArea.innerHTML = `<div class="alert alert-warning">æ‰¾ä¸åˆ°ä»£è™Ÿ ${input} æˆ–è³‡æ–™åº«å°šæœªæ”¶éŒ„ã€‚</div>`;
        }
    }
</script>

</body>
</html>